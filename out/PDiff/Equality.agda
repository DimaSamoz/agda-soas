{-
This second-order equational theory was created from the following second-order syntax description:

syntax PDiff | PD

type
  * : 0-ary

term
  zero  : * | ğŸ˜
  add   : *  *  ->  * | _âŠ•_ l20
  one   : * | ğŸ™
  mult  : *  *  ->  * | _âŠ—_ l20
  neg   : *  ->  * | âŠ–_ r50
  pdiff : *.*  *  ->  * | âˆ‚_âˆ£_

theory
  (ğŸ˜UâŠ•á´¸) a |> add (zero, a) = a
  (ğŸ˜UâŠ•á´¿) a |> add (a, zero) = a
  (âŠ•A) a b c |> add (add(a, b), c) = add (a, add(b, c))
  (âŠ•C) a b |> add(a, b) = add(b, a)
  (ğŸ™UâŠ—á´¸) a |> mult (one, a) = a
  (ğŸ™UâŠ—á´¿) a |> mult (a, one) = a
  (âŠ—A) a b c |> mult (mult(a, b), c) = mult (a, mult(b, c))
  (âŠ—DâŠ•á´¸) a b c |> mult (a, add (b, c)) = add (mult(a, b), mult(a, c))
  (âŠ—DâŠ•á´¿) a b c |> mult (add (a, b), c) = add (mult(a, c), mult(b, c))
  (ğŸ˜XâŠ—á´¸) a |> mult (zero, a) = zero
  (ğŸ˜XâŠ—á´¿) a |> mult (a, zero) = zero
  (âŠ–NâŠ•á´¸) a |> add (neg (a), a) = zero
  (âŠ–NâŠ•á´¿) a |> add (a, neg (a)) = zero
  (âŠ—C) a b |> mult(a, b) = mult(b, a)
  (âˆ‚âŠ•) a : * |> x : * |- d0 (add (x, a)) = one
  (âˆ‚âŠ—) a : * |> x : * |- d0 (mult(a, x)) = a
  (âˆ‚C) f : (*,*).* |> x : *  y : * |- d1 (d0 (f[x,y])) = d0 (d1 (f[x,y]))
  (âˆ‚Châ‚‚) f : (*,*).*  g h : *.* |> x : * |- d0 (f[g[x], h[x]]) = add (mult(pdiff(z. f[z, h[x]], g[x]), d0(g[x])), mult(pdiff(z. f[g[x], z], h[x]), d0(h[x])))
  (âˆ‚Châ‚) f g : *.* |> x : * |- d0 (f[g[x]]) = mult (pdiff (z. f[z], g[x]), d0(g[x]))
-}

module PDiff.Equality where

open import SOAS.Common
open import SOAS.Context
open import SOAS.Variable
open import SOAS.Families.Core
open import SOAS.Families.Build
open import SOAS.ContextMaps.Inductive

open import PDiff.Signature
open import PDiff.Syntax

open import SOAS.Metatheory.SecondOrder.Metasubstitution PD:Syn
open import SOAS.Metatheory.SecondOrder.Equality PD:Syn
open import SOAS.Metatheory

open PD:Syntax
open import SOAS.Syntax.Shorthands PDáµƒ

private
  variable
    Î± Î² Î³ Ï„ : *T
    Î“ Î” Î  : Ctx

infix 1 _â–¹_âŠ¢_â‰‹â‚_

-- Axioms of equality
data _â–¹_âŠ¢_â‰‹â‚_ : âˆ€ ğ” Î“ {Î±} â†’ (ğ” â–· PD) Î± Î“ â†’ (ğ” â–· PD) Î± Î“ â†’ Set where
  ğŸ˜UâŠ•á´¸ : â… * â†Ì£             â–¹     âˆ…     âŠ¢               ğŸ˜ âŠ• ğ” â‰‹â‚ ğ”
  âŠ•A   : â… * â† â… * â† â… * â†Ì£ â–¹     âˆ…     âŠ¢         (ğ” âŠ• ğ”Ÿ) âŠ• ğ”  â‰‹â‚ ğ” âŠ• (ğ”Ÿ âŠ• ğ” )
  âŠ•C   : â… * â† â… * â†Ì£       â–¹     âˆ…     âŠ¢               ğ” âŠ• ğ”Ÿ â‰‹â‚ ğ”Ÿ âŠ• ğ”
  ğŸ™UâŠ—á´¸ : â… * â†Ì£             â–¹     âˆ…     âŠ¢               ğŸ™ âŠ— ğ” â‰‹â‚ ğ”
  âŠ—A   : â… * â† â… * â† â… * â†Ì£ â–¹     âˆ…     âŠ¢         (ğ” âŠ— ğ”Ÿ) âŠ— ğ”  â‰‹â‚ ğ” âŠ— (ğ”Ÿ âŠ— ğ” )
  âŠ—DâŠ•á´¸ : â… * â† â… * â† â… * â†Ì£ â–¹     âˆ…     âŠ¢         ğ” âŠ— (ğ”Ÿ âŠ• ğ” ) â‰‹â‚ (ğ” âŠ— ğ”Ÿ) âŠ• (ğ” âŠ— ğ” )
  ğŸ˜XâŠ—á´¸ : â… * â†Ì£             â–¹     âˆ…     âŠ¢               ğŸ˜ âŠ— ğ” â‰‹â‚ ğŸ˜
  âŠ–NâŠ•á´¸ : â… * â†Ì£             â–¹     âˆ…     âŠ¢           (âŠ– ğ”) âŠ• ğ” â‰‹â‚ ğŸ˜
  âŠ—C   : â… * â† â… * â†Ì£       â–¹     âˆ…     âŠ¢               ğ” âŠ— ğ”Ÿ â‰‹â‚ ğ”Ÿ âŠ— ğ”
  âˆ‚âŠ•   : â… * â†Ì£             â–¹   âŒŠ * âŒ‹   âŠ¢         âˆ‚â‚€ (xâ‚€ âŠ• ğ”) â‰‹â‚ ğŸ™
  âˆ‚âŠ—   : â… * â†Ì£             â–¹   âŒŠ * âŒ‹   âŠ¢         âˆ‚â‚€ (ğ” âŠ— xâ‚€) â‰‹â‚ ğ”
  âˆ‚C   : â… * Â· * âŠ© * â†Ì£     â–¹ âŒŠ * âˆ™ * âŒ‹ âŠ¢  âˆ‚â‚ âˆ‚â‚€ ğ”âŸ¨ xâ‚€ â—‚ xâ‚ âŸ© â‰‹â‚ âˆ‚â‚€ âˆ‚â‚ ğ”âŸ¨ xâ‚€ â—‚ xâ‚ âŸ©
  âˆ‚Châ‚‚ : â… * Â· * âŠ© * â† â… * âŠ© * â† â… * âŠ© * â†Ì£ â–¹ âŒŠ * âŒ‹
       âŠ¢ âˆ‚â‚€ ğ”âŸ¨ (ğ”ŸâŸ¨ xâ‚€ âŸ©) â—‚ (ğ” âŸ¨ xâ‚€ âŸ©) âŸ© â‰‹â‚ ((âˆ‚ ğ”âŸ¨ xâ‚€ â—‚ (ğ” âŸ¨ xâ‚ âŸ©) âŸ© âˆ£ ğ”ŸâŸ¨ xâ‚€ âŸ©) âŠ— (âˆ‚â‚€ ğ”ŸâŸ¨ xâ‚€ âŸ©))
                                       âŠ• ((âˆ‚ ğ”âŸ¨ (ğ”ŸâŸ¨ xâ‚ âŸ©) â—‚ xâ‚€ âŸ© âˆ£ ğ” âŸ¨ xâ‚€ âŸ©) âŠ— (âˆ‚â‚€ ğ” âŸ¨ xâ‚€ âŸ©))

open EqLogic _â–¹_âŠ¢_â‰‹â‚_
open â‰‹-Reasoning

-- Derived equations
ğŸ˜UâŠ•á´¿ : â… * â†Ì£ â–¹ âˆ… âŠ¢ ğ” âŠ• ğŸ˜ â‰‹ ğ”
ğŸ˜UâŠ•á´¿ = tr (ax âŠ•C withã€Š ğ” â—ƒ ğŸ˜ ã€‹) (ax ğŸ˜UâŠ•á´¸ withã€Š ğ” ã€‹)
ğŸ™UâŠ—á´¿ : â… * â†Ì£ â–¹ âˆ… âŠ¢ ğ” âŠ— ğŸ™ â‰‹ ğ”
ğŸ™UâŠ—á´¿ = tr (ax âŠ—C withã€Š ğ” â—ƒ ğŸ™ ã€‹) (ax ğŸ™UâŠ—á´¸ withã€Š ğ” ã€‹)
âŠ—DâŠ•á´¿ : â… * â† â… * â† â… * â†Ì£ â–¹ âˆ… âŠ¢ (ğ” âŠ• ğ”Ÿ) âŠ— ğ”  â‰‹ (ğ” âŠ— ğ” ) âŠ• (ğ”Ÿ âŠ— ğ” )
âŠ—DâŠ•á´¿ = begin
  (ğ” âŠ• ğ”Ÿ) âŠ— ğ”        â‰‹âŸ¨ ax âŠ—C withã€Š ğ” âŠ• ğ”Ÿ â—ƒ ğ”  ã€‹ âŸ©
  ğ”  âŠ— (ğ” âŠ• ğ”Ÿ)       â‰‹âŸ¨ ax âŠ—DâŠ•á´¸ withã€Š ğ”  â—ƒ ğ” â—ƒ ğ”Ÿ ã€‹ âŸ©
  (ğ”  âŠ— ğ”) âŠ• (ğ”  âŠ— ğ”Ÿ)  â‰‹âŸ¨ congâ‚‚[ ax âŠ—C withã€Š ğ”  â—ƒ ğ” ã€‹ ][ ax âŠ—C withã€Š ğ”  â—ƒ ğ”Ÿ ã€‹ ]inside â—Œáµˆ âŠ• â—Œáµ‰ âŸ©
  (ğ” âŠ— ğ” ) âŠ• (ğ”Ÿ âŠ— ğ” )  âˆ
ğŸ˜XâŠ—á´¿ : â… * â†Ì£ â–¹ âˆ… âŠ¢ ğ” âŠ— ğŸ˜ â‰‹ ğŸ˜
ğŸ˜XâŠ—á´¿ = tr (ax âŠ—C withã€Š ğ” â—ƒ ğŸ˜ ã€‹) (ax ğŸ˜XâŠ—á´¸ withã€Š ğ” ã€‹)
âŠ–NâŠ•á´¿ : â… * â†Ì£ â–¹ âˆ… âŠ¢ ğ” âŠ• (âŠ– ğ”) â‰‹ ğŸ˜
âŠ–NâŠ•á´¿ = tr (ax âŠ•C withã€Š ğ” â—ƒ (âŠ– ğ”) ã€‹) (ax âŠ–NâŠ•á´¸ withã€Š ğ” ã€‹)

-- Derivative of a variable is 1
âˆ‚id : â…â† â–¹ âŒŠ * âŒ‹ âŠ¢ âˆ‚â‚€ xâ‚€ â‰‹ ğŸ™
âˆ‚id = begin
      âˆ‚â‚€ xâ‚€       â‰‹âŸ¨ cong[ thm ğŸ˜UâŠ•á´¿ withã€Š xâ‚€ ã€‹ ]inside âˆ‚â‚€ â—Œáµƒ âŸ©â‚›
      âˆ‚â‚€ (xâ‚€ âŠ• ğŸ˜) â‰‹âŸ¨ ax âˆ‚âŠ• withã€Š ğŸ˜ ã€‹ âŸ©
      ğŸ™           âˆ

-- Derivative of 0 is 0
âˆ‚ğŸ˜ : â…â† â–¹ âŒŠ * âŒ‹ âŠ¢ âˆ‚â‚€ ğŸ˜ â‰‹ ğŸ˜
âˆ‚ğŸ˜ = begin
      âˆ‚â‚€ ğŸ˜         â‰‹âŸ¨ cong[ ax ğŸ˜XâŠ—á´¸ withã€Š xâ‚€ ã€‹ ]inside âˆ‚â‚€ â—Œáµƒ âŸ©â‚›
      âˆ‚â‚€ (ğŸ˜ âŠ— xâ‚€)  â‰‹âŸ¨ ax âˆ‚âŠ— withã€Š ğŸ˜ ã€‹ âŸ©
      ğŸ˜            âˆ

-- Unary chain rule
âˆ‚Châ‚ : â… * âŠ© * â† â… * âŠ© * â†Ì£ â–¹ âŒŠ * âŒ‹
     âŠ¢ âˆ‚â‚€ ğ”âŸ¨ (ğ”ŸâŸ¨ xâ‚€ âŸ©) âŸ© â‰‹ (âˆ‚ ğ”âŸ¨ xâ‚€ âŸ© âˆ£ ğ”ŸâŸ¨ xâ‚€ âŸ©) âŠ— (âˆ‚â‚€ ğ”ŸâŸ¨ xâ‚€ âŸ©)
âˆ‚Châ‚ = begin
      âˆ‚â‚€ (ğ”âŸ¨ (ğ”ŸâŸ¨ xâ‚€ âŸ©) âŸ©)
  â‰‹âŸ¨ ax âˆ‚Châ‚‚ withã€Š ğ”âŸ¨ xâ‚€ âŸ© â—ƒ ğ”ŸâŸ¨ xâ‚€ âŸ© â—ƒ ğŸ˜ ã€‹ âŸ©
        (âˆ‚ ğ”âŸ¨ xâ‚€ âŸ© âˆ£ (ğ”ŸâŸ¨ xâ‚€ âŸ©)) âŠ— (âˆ‚â‚€ (ğ”ŸâŸ¨ xâ‚€ âŸ©))
      âŠ• ((âˆ‚ ğ”âŸ¨ (ğ”ŸâŸ¨ xâ‚ âŸ©) âŸ© âˆ£ ğŸ˜) âŠ— (âˆ‚â‚€ ğŸ˜))
  â‰‹âŸ¨ cong[ thm âˆ‚ğŸ˜ ]inside (âˆ‚ ğ”âŸ¨ xâ‚€ âŸ© âˆ£ (ğ”ŸâŸ¨ xâ‚€ âŸ©)) âŠ— (âˆ‚â‚€ (ğ”ŸâŸ¨ xâ‚€ âŸ©)) âŠ•
                          ((âˆ‚ ğ”âŸ¨ (ğ”ŸâŸ¨ xâ‚ âŸ©) âŸ© âˆ£ ğŸ˜) âŠ— â—Œá¶œ) âŸ©
        (âˆ‚ ğ”âŸ¨ xâ‚€ âŸ© âˆ£ (ğ”ŸâŸ¨ xâ‚€ âŸ©)) âŠ— (âˆ‚â‚€ (ğ”ŸâŸ¨ xâ‚€ âŸ©))
      âŠ• (âˆ‚ ğ”âŸ¨ (ğ”ŸâŸ¨ xâ‚ âŸ©) âŸ© âˆ£ ğŸ˜) âŠ— ğŸ˜
  â‰‹âŸ¨ cong[ thm ğŸ˜XâŠ—á´¿ withã€Š (âˆ‚ ğ”âŸ¨ (ğ”ŸâŸ¨ xâ‚ âŸ©) âŸ© âˆ£ ğŸ˜) ã€‹ ]inside (âˆ‚ ğ”âŸ¨ xâ‚€ âŸ© âˆ£ (ğ”ŸâŸ¨ xâ‚€ âŸ©)) âŠ— (âˆ‚â‚€ (ğ”ŸâŸ¨ xâ‚€ âŸ©)) âŠ• â—Œá¶œ âŸ©
        (âˆ‚ ğ”âŸ¨ xâ‚€ âŸ© âˆ£ (ğ”ŸâŸ¨ xâ‚€ âŸ©)) âŠ— (âˆ‚â‚€ (ğ”ŸâŸ¨ xâ‚€ âŸ©))
      âŠ• ğŸ˜
  â‰‹âŸ¨ thm ğŸ˜UâŠ•á´¿ withã€Š (âˆ‚ ğ”âŸ¨ xâ‚€ âŸ© âˆ£ (ğ”ŸâŸ¨ xâ‚€ âŸ©)) âŠ— (âˆ‚â‚€ (ğ”ŸâŸ¨ xâ‚€ âŸ©)) ã€‹ âŸ©
      (âˆ‚ ğ”âŸ¨ xâ‚€ âŸ© âˆ£ ğ”ŸâŸ¨ xâ‚€ âŸ©) âŠ— (âˆ‚â‚€ ğ”ŸâŸ¨ xâ‚€ âŸ©)
  âˆ
